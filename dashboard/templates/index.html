<!DOCTYPE html>
<html>
<head>
    <title>Sentinel Dashboard</title>
    <style>
        body { font-family: Arial; }
        .device-box {
            border: 1px solid #ccc;
            padding: 15px;
            margin: 10px;
            width: 350px;
        }
        pre { background: #eee; padding: 5px; }
    </style>
</head>
<body>

<h1>Sentinel Dashboard</h1>

<div id="devices">
{% for name, info in devices.items() %}
    <div class="device-box" id="box-{{ name }}">
        <h3>{{ name }} ({{ info.class }})</h3>

        <strong>State:</strong>
        <pre id="state-{{ name }}">{{ live_state.get(name) or "No Data" }}</pre>

        <p>
            <a href="/command/{{ name }}/on">Turn ON</a> |
            <a href="/command/{{ name }}/off">Turn OFF</a>
        </p>
    </div>
{% endfor %}
</div>

<script>
// Auto-update using SSE
const evt = new EventSource("/events");

evt.onmessage = function (event) {
    const update = JSON.parse(event.data);
    const device = Object.keys(update)[0];
    const state = update[device];

    const el = document.getElementById("state-" + device);
    if (el) {
        el.textContent = JSON.stringify(state, null, 2);
    }
};
</script>

</body>
</html>
